<!DOCTYPE html>
<html>
<head>
<title>Tiled WMS example</title>
    <link href='https://fonts.googleapis.com/css?family=Raleway:400' rel='stylesheet' type='text/css'>

<script src="http://openlayers.org/en/v3.0.0/resources/bootstrap/css/bootstrap-responsive.min.css"></script>
<link rel="stylesheet" href="http://openlayers.org/en/v3.8.2/css/ol.css" type="text/css">
<script src="http://openlayers.org/en/v3.10.1/build/ol.js"></script>
    

<link rel="stylesheet" href="./material.css">
<script src="./material.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
<script type='text/javascript' src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
<script type='text/javascript' src='https://code.jquery.com/ui/1.11.4/jquery-ui.min.js'></script>

    
    
    
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>
    
<style>
html{ 
    height:100%}
body{font-family: 'Raleway', sans-serif;
    height:100%}
#map{
  height:100%;
  width:100%;
     
}
    .ol-zoom  {
    left: 97%;
        top: 85 %;
        
    }
</style>

<body>
    
  <!-- Uses a header that scrolls with the text, rather than staying
  locked at the top -->
<div class="mdl-layout mdl-js-layout">
  <header class="mdl-layout__header mdl-layout__header--scroll">
    <div class="mdl-layout__header-row">
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
        
    <input class="mdl-textfield__input" type="text" id="sample3" />
    <label style="display:inline-block; " class="mdl-textfield__label" id="sample3">Rechercher dans Montepellier Eve
        </label> 
        
   
  </div>
          <img style="display:inline-block; " src="search.png">
    </div>
  </header>
  <div id="slidemenu" class="mdl-layout__drawer">
  <!--  <span class="mdl-layout-title">le nom du evenement</span>-->
      <div class="span4 offset4">
          <div id="info" class="alert alert-success">
          
          </div>
        </div>
  
  </div>
    <div class="map" id="map"><div id="popup"></div></div>
  
</div>
    
    
    
    
    
    
    
    
    
    
    	

    
    
<script>
    
    //Book example 
  /*  
var fill = new ol.style.Fill({
color: 'rgba(0,0,0,0.2)'
});
var stroke = new ol.style.Stroke({
color: 'rgba(0,0,0,0.4)'
});
var circle = new ol.style.Circle({
radius: 6,
fill: fill,
stroke: stroke
    });
    
var vectorStyle = new ol.style.Style({
fill: fill,
stroke: stroke,
image: circle
});
    
var vectorLoader = function(extent, resolution, projection) {
var url = 'http://myapp-faisalkanout.rhcloud.com/geoserver/wfs?service=WFS&' +
        'version=1.1.0&request=GetFeature&typename=montpellier:VilleMTP_MTP_ArretsL1&' +
        'outputFormat=text/javascript&format_options=callback:loadFeatures' +
        '&srsname=EPSG:3857&bbox=' + extent.join(',') + ',EPSG:3857';
$.ajax({
    url: url,
    dataType: 'jsonp'
    });
};
var loadFeatures = function(response) {
var features = vectorSource.readFeatures(response);
vectorSource.addFeatures(features);
    };

 
var vectorSource = new ol.source.ServerVector({
format: new ol.format.GeoJSON(),
loader: vectorLoader,
strategy: ol.loadingstrategy.tile(new ol.tilegrid.createXYZ({
maxZoom: 19
        })),
projection: 'EPSG:3857',
});
    
var serverVector = new ol.layer.vector({
source: vectorSource,
style: vectorStyle,
    visible:true
});
    
   */ 
     
    var fill = new ol.style.Fill({
color: 'rgba(0,0,0,0.2)'
});
var stroke = new ol.style.Stroke({
color: 'rgba(0,0,0,0.4)'
});
var circle = new ol.style.Circle({
radius: 6,
fill: fill,
stroke: stroke
    });
    
var vectorStyle = new ol.style.Style({
    cursor: "pointer",
fill: fill,
stroke: stroke,
image: circle
});
    
    
 var geojsonFormat = new ol.format.GeoJSON();

var vectorSource = new ol.source.Vector({
  loader: function(extent, resolution, projection) {
    var url = 'http://myapp-faisalkanout.rhcloud.com/geoserver/wfs?service=WFS&' +
        'version=1.1.0&request=GetFeature&typename=montpellier:EveCorrect&' +
        'outputFormat=text/javascript&format_options=callback:loadFeatures' +
        '&srsname=EPSG:3857&bbox=' + extent.join(',') + ',EPSG:3857';
    // use jsonp: false to prevent jQuery from adding the "callback"
    // parameter to the URL
    $.ajax({url: url, dataType: 'jsonp', jsonp: false});
  },
  strategy: ol.loadingstrategy.tile(new ol.tilegrid.createXYZ({
    maxZoom: 16
  }))
});

    // the global function whose name is specified in the URL of JSONP WFS
// GetFeature requests
var loadFeatures = function(response) {
  vectorSource.addFeatures(geojsonFormat.readFeatures(response));
};

var vector = new ol.layer.Vector({
  source: vectorSource,
  style: vectorStyle
});

    
/*
    
    
   
var sourceVector = new ol.source.Vector({
	loader: function(extent) {
		$.ajax('http://myapp-faisalkanout.rhcloud.com/geoserver/wfs',{
			type: 'GET',
			data: {
				service: 'WFS',
				version: '1.1.0',
				request: 'GetFeature',
				typename: 'montpellier:EveCorrect',
				srsname: 'EPSG:3857',
                
				bbox: extent.join(',') + ',EPSG:3857'
				},
			}).done(loadFeatures);
		},
	strategy: ol.loadingstrategy.tile(new ol.tilegrid.createXYZ({
    maxZoom: 19
  }))

});

 

    
 window.loadFeatures = function(response) {
    formatWFS = new ol.format.WFS(),
    sourceVector.addFeatures(formatWFS.readFeatures(response));
    };

var layerVector = new ol.layer.Vector({
    source: sourceVector,
    style: new ol.style.Style({
        cursor: "pointer",
        stroke: new ol.style.Stroke({
            color: 'rgba(0, 0, 255, 1.0)',
            width: 100
            })
        })
    });

    
       
*/
var slidemenu = document.getElementById('slidemenu');
    
var wmsSource = new ol.source.TileWMS({
  url: 'http://myapp-faisalkanout.rhcloud.com/geoserver/wms',
  params: {'LAYERS':'montpellier:EveCorrect'},
  serverType: 'geoserver',
 transparent: true,
  isBaseLayer: false, opacity: 1, singleTile: true, visibility: true
});
var wmsLayer = new ol.layer.Tile({
  source: wmsSource
});    
    
    
var layers = [
    new ol.layer.Tile({
           source: new ol.source.MapQuest({layer: 'osm'})
        }),
 vector
];

var view= new ol.View({
    center:  [431735.4450117468, 5405225.345929167],
    zoom: 13    
    });
var map = new ol.Map({
    layers: layers,
    
    target: 'map',
    view: view,
    loadTilesWhileAnimating:true,
    loadTilesWhileInteracting:true
    
    });
    zoomslider = new ol.control.ZoomSlider();
  map.addControl(zoomslider);

    
map.on('singleclick', function(evt) {
    
  document.getElementById('info').innerHTML = '';
   
  var viewResolution = /** @type {number} */ (view.getResolution());
  var url = wmsSource.getGetFeatureInfoUrl(
      evt.coordinate, viewResolution, 'EPSG:3857',
      {'INFO_FORMAT': 'text/html'});
  if (url) {
    document.getElementById('info').innerHTML =
        '<iframe seamless src="' + url + '"></iframe>';
        slidemenu.className="mdl-layout__drawer is-visible";

  }
});

    


    
</script>
</body>
</html>